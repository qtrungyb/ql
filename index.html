<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MƠ COFFEE</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 10px;
            background-color: #f0f0f0;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 20px;
        }

        .header h1 {
            margin: 0;
            color: #333;
        }

        .date {
            font-size: 18px;
            color: #555;
            margin-top: 5px;
        }

        .category {
            margin-bottom: 20px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .category-title {
            padding: 15px;
            font-size: 20px;
            color: white;
            text-align: center;
            font-weight: bold;
        }

        .matcha .category-title {
            background-color: #8BC34A;
            /* Màu xanh lá Matcha */
        }

        .cacao .category-title {
            background-color: #795548;
            /* Màu nâu Cacao */
        }

        .cafe .category-title {
            background-color: #5D4037;
            /* Màu nâu đậm Cafe */
        }

        .other .category-title {
            background-color: #9E9E9E;
            /* Màu xám Khác */
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
        }

        .table th,
        .table td {
            padding: 10px;
            text-align: center;
            border-bottom: 1px solid #ddd;
            font-size: 16px;
        }

        .table th {
            background-color: #f5f5f5;
        }

        .btn-sell,
        .btn-cancel {
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            margin: 0 2px;
            font-size: 12px;
        }

        .btn-sell {
            background-color: #4CAF50;
        }

        .btn-cancel {
            background-color: #F44336;
        }

        .summary {
            background-color: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
            text-align: center;
        }
		.highlight {
    color: #FF5722; /* Màu cam cho số cốc và tổng doanh thu */
    font-weight: bold; /* Làm chữ đậm */
    font-size: 20px; /* Tăng kích thước chữ nếu cần */
}
		

        .reset-btn {
            margin-top: 10px;
            padding: 10px 20px;
            background-color: #F44336;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .btn-edit {
            background-color: #FFC107;
            /* Màu vàng */
            color: white;
            border: none;
            padding: 5px 10px;
            margin: 0 2px;
            border-radius: 5px;
            cursor: pointer;
			font-size: 8px;
        }       
            
        .btn-delete {
            background-color: #E57373;
            /* Màu đỏ nhạt */
            color: white;
            border: none;
            padding: 5px 10px;
            margin: 0 2px;
            border-radius: 5px;
            cursor: pointer;
			font-size: 8px;
        }

        .btn-add {
            background-color: #64B5F6;
            /* Màu xanh dương nhạt */
            color: white;
            border: none;
            padding: 10px 15px;
            margin-top: 10px;
            border-radius: 5px;
            cursor: pointer;
        }

        @media (max-width: 600px) {

            .table th,
            .table td {
                padding: 8px;
                font-size: 12px;
            }

            .btn-sell,
            .btn-cancel {
                padding: 3px 6px;
                font-size: 10px;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>THEO DÕI SỐ LƯỢNG</h1>
            <div class="date" id="currentDate"></div>
        </div>

        <div class="category matcha">
            <div class="category-title">MATCHA</div>
            <table class="table" id="matchaTable">
                <thead>
                    <tr>
                        <th>Tên Đồ Uống</th>
                        <th>Giá (VND)</th>
                        <th>Số Lượng</th>
                        <th>Thao Tác</th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
            <button class="btn-add" onclick="addItem('matcha')">Thêm mới đồ uống</button>
        </div>

        <div class="category cacao">
            <div class="category-title">CACAO</div>
            <table class="table" id="cacaoTable">
                <thead>
                    <tr>
                        <th>Tên Đồ Uống</th>
                        <th>Giá (VND)</th>
                        <th>Số Lượng</th>
                        <th>Thao Tác</th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
            <button class="btn-add" onclick="addItem('cacao')">Thêm mới đồ uống</button>
        </div>

        <div class="category cafe">
            <div class="category-title">CAFE</div>
            <table class="table" id="cafeTable">
                <thead>
                    <tr>
                        <th>Tên Đồ Uống</th>
                        <th>Giá (VND)</th>
                        <th>Số Lượng</th>
                        <th>Thao Tác</th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
            <button class="btn-add" onclick="addItem('cafe')">Thêm mới đồ uống</button>
        </div>

        <div class="category other">
            <div class="category-title">KHÁC</div>
            <table class="table" id="otherTable">
                <thead>
                    <tr>
                        <th>Tên Đồ Uống</th>
                        <th>Giá (VND)</th>
                        <th>Số Lượng</th>
                        <th>Thao Tác</th>
                    </tr>
                </thead>
                <tbody>
                    </tbody>
            </table>
            <button class="btn-add" onclick="addItem('other')">Thêm mới đồ uống</button>
        </div>

        <div class="summary">
    <h2>TỔNG KẾT NGÀY</h2>
    <p>Tổng bán: <span id="totalQuantity" class="highlight">0</span></p>
    <p>Tổng doanh thu: <span id="totalRevenue" class="highlight">0</span> VND</p>
    <button class="reset-btn" onclick="resetDay()">Reset Ngày</button>
</div>
    </div>

    <script>
        // Hiển thị ngày tháng năm hiện tại
        const currentDateElement = document.getElementById('currentDate');
        const today = new Date();
        currentDateElement.textContent = today.toLocaleDateString('vi-VN');

        // Khởi tạo drinkList từ localStorage hoặc tạo mới
        let drinkList = JSON.parse(localStorage.getItem('drinkList')) || {
            'matcha': [
                { name: 'Matcha Latte', price: 25000 },
                { name: 'Matcha Trà Xanh', price: 20000 }
            ],
            'cacao': [
                { name: 'Cacao Nóng', price: 25000 },
                { name: 'Cacao Đá', price: 20000 }
            ],
            'cafe': [
                { name: 'Cafe Sữa', price: 20000 },
                { name: 'Cafe Đen', price: 18000 }
            ],
            'other': [
                { name: 'Trà Sữa', price: 30000 },
                { name: 'Nước Ép Cam', price: 25000 }
            ]
        };

        // Khởi tạo salesData từ localStorage hoặc tạo mới
        let salesData = JSON.parse(localStorage.getItem('salesData')) || {};
        let lastResetDate = localStorage.getItem('lastResetDate') || today.toLocaleDateString('vi-VN');

        // Kiểm tra nếu ngày hiện tại khác ngày reset cuối cùng thì reset dữ liệu
        if (lastResetDate !== today.toLocaleDateString('vi-VN')) {
            salesData = {};
            localStorage.setItem('salesData', JSON.stringify(salesData));
            localStorage.setItem('lastResetDate', today.toLocaleDateString('vi-VN'));
        }

        // Gọi updateUI() khi trang tải để hiển thị dữ liệu từ localStorage
        updateUI();

        // Bán một sản phẩm
        function sellItem(itemName) {
            if (confirm(`Bạn có chắc chắn muốn bán 1 cốc ${itemName}?`)) {
                if (!salesData[itemName]) {
                    salesData[itemName] = {
                        quantity: 0
                    };
                }
                salesData[itemName].quantity += 1;
                localStorage.setItem('salesData', JSON.stringify(salesData));
                updateUI();
            }
        }

        // Hủy một sản phẩm
        function cancelItem(itemName) {
            if (salesData[itemName] && salesData[itemName].quantity > 0) {
                if (confirm(`Bạn có chắc chắn muốn hủy 1 cốc ${itemName}?`)) {
                    salesData[itemName].quantity -= 1;
                    localStorage.setItem('salesData', JSON.stringify(salesData));
                    updateUI();
                }
            } else {
                alert(`Số lượng ${itemName} đã là 0, không thể hủy!`);
            }
        }

        // Sửa tên và giá đồ uống
        function editItem(oldName) {
            let newName = prompt("Nhập tên mới cho " + oldName + ":", oldName);
            if (newName) {
                let newPrice = prompt("Nhập giá mới cho " + oldName + ":", prompt("Nhập giá hiện tại:"));
                if (newPrice) {
                    updateItemDetails(oldName, newName, newPrice);
                    updateUI();
                    saveSalesData();
                }
            }
        }

        function updateItemDetails(oldName, newName, newPrice) {
            document.querySelectorAll('table').forEach(table => {
                table.querySelectorAll('tr').forEach(row => {
                    if (row.cells[0].textContent === oldName) {
                        row.cells[0].textContent = newName;
                        row.cells[1].textContent = newPrice;
                        row.cells[2].setAttribute('data-item', newName);
                        row.cells[3].innerHTML = `
                            <button class="btn-sell" onclick="sellItem('<span class="math-inline">\{newName\}'\)"\>Bán</button\>
<button class\="btn\-cancel" onclick\="cancelItem\('</span>{newName}')">Hủy</button>
                            <button class="btn-edit" onclick="editItem('<span class="math-inline">\{newName\}'\)"\>Sửa</button\>
<button class\="btn\-delete" onclick\="deleteItem\('</span>{newName}')">Xóa</button>
                        `;
                    }
                });
            });

            // Cập nhật drinkList
            for (let category in drinkList) {
                drinkList[category].forEach(drink => {
                    if (drink.name === oldName) {
                        drink.name = newName;
                        drink.price = parseInt(newPrice);
                    }
                });
            }
            localStorage.setItem('drinkList', JSON.stringify(drinkList));

            if (salesData[oldName]) {
                salesData[newName] = {
                    ...salesData[oldName]
                };
                delete salesData[oldName];
            }
        }

        // Xóa đồ uống
        function deleteItem(itemName) {
            if (confirm("Bạn có chắc chắn muốn xóa " + itemName + "?")) {
                deleteItemFromTable(itemName);
                updateDrinkList(itemName); // Cập nhật drinkList
                delete salesData[itemName];
                updateUI();
                saveSalesData();
            }
        }

        function deleteItemFromTable(itemName) {
            document.querySelectorAll('table').forEach(table => {
                table.querySelectorAll('tr').forEach(row => {
                    if (row.cells[0].textContent === itemName) {
                        row.remove();
                    }
                });
            });
        }

        function updateDrinkList(itemName) {
            for (let category in drinkList) {
                drinkList[category] = drinkList[category].filter(drink => drink.name !== itemName);
            }
            localStorage.setItem('drinkList', JSON.stringify(drinkList));
        }

        // Thêm đồ uống mới
        function addItem(category) {
            let newName = prompt("Nhập tên đồ uống mới:", "");
            if (newName) {
                let newPrice = prompt("Nhập giá cho " + newName + ":", "");
                if (newPrice) {
                    addItemToTable(category, newName, newPrice);
                    salesData[newName] = {
                        quantity: 0
                    };
                    updateUI();
                    saveSalesData();
                }
            }
        }

        function addItemToTable(category, name, price) {
            let tableId = category + "Table";
            let table = document.getElementById(tableId);
            let newRow = table.insertRow(table.rows.length);
            newRow.innerHTML = `
                <td><span class="math-inline">\{name\}</td\>
<td\></span>{price}</td>
                <td class="quantity" data-item="<span class="math-inline">\{name\}"\>0</td\>
<td\>
<button class\="btn\-sell" onclick\="sellItem\('</span>{name}')">Bán</button>
                    <button class="btn-cancel" onclick="cancelItem('<span class="math-inline">\{name\}'\)"\>Hủy</button\>
<button class\="btn\-edit" onclick\="editItem\('</span>{name}')">Sửa</button>
                    <button class="btn-delete" onclick="deleteItem('${name}')">Xóa</button>
                </td>
            `;
            // Cập nhật drinkList và lưu vào localStorage
            drinkList[category].push({
                name: name,
                price: parseInt(price)
            });
            localStorage.setItem('drinkList', JSON.stringify(drinkList));
        }

        // Lưu dữ liệu vào localStorage
        function saveSalesData() {
            localStorage.setItem('salesData', JSON.stringify(salesData));
        }

        // Reset dữ liệu ngày
        function resetDay() {
            if (confirm('Bạn có chắc chắn muốn reset dữ liệu ngày hôm nay? Dữ liệu sẽ không thể khôi phục!')) {
                salesData = {};
                localStorage.setItem('salesData', JSON.stringify(salesData));
                localStorage.setItem('lastResetDate', today.toLocaleDateString('vi-VN'));
                updateUI();
            }
        }

        function updateUI() {
            // Load lại danh sách đồ uống từ localStorage
            drinkList = JSON.parse(localStorage.getItem('drinkList')) || {
                'matcha': [
                    { name: 'Matcha Latte', price: 25000 },
                    { name: 'Matcha Trà Xanh', price: 20000 }
                ],
                'cacao': [
                    { name: 'Cacao Nóng', price: 25000 },
                    { name: 'Cacao Đá', price: 20000 }
                ],
                'cafe': [
                    { name: 'Cafe Sữa', price: 20000 },
                    { name: 'Cafe Đen', price: 18000 }
                ],
                'other': [
                    { name: 'Trà Sữa', price: 30000 },
                    { name: 'Nước Ép Cam', price: 25000 }
                ]
            };

            // Cập nhật bảng
            for (let category in drinkList) {
                let tableId = category + 'Table';
                let table = document.getElementById(tableId);
			// Xóa các hàng cũ (trừ header)
                while (table.rows.length > 1) {
                    table.deleteRow(1);
                }
                // Thêm các hàng mới từ drinkList
                drinkList[category].forEach(drink => {
                    let newRow = table.insertRow(table.rows.length);
                    newRow.innerHTML = `
                        <td>${drink.name}</td>
                        <td>${drink.price}</td>
                        <td class="quantity" data-item="${drink.name}">${salesData[drink.name]?.quantity || 0}</td>
                        <td>
                            <button class="btn-sell" onclick="sellItem('${drink.name}')">Bán</button>
                            <button class="btn-cancel" onclick="cancelItem('${drink.name}')">Hủy</button>
                            <button class="btn-edit" onclick="editItem('${drink.name}')">Sửa</button>
                            <button class="btn-delete" onclick="deleteItem('${drink.name}')">Xóa</button>
                        </td>
                    `;
                });
            }

            // Cập nhật tổng số lượng và doanh thu
            const quantities = document.querySelectorAll('.quantity');
            let totalQty = 0;
            let totalRev = 0;

            quantities.forEach(qtyElement => {
                const itemName = qtyElement.getAttribute('data-item');
                const quantity = salesData[itemName]?.quantity || 0;
                const price = parseInt(qtyElement.parentElement.children[1].textContent);
                totalQty += quantity;
                totalRev += quantity * price;
            });

            document.getElementById('totalQuantity').textContent = totalQty;
            document.getElementById('totalRevenue').textContent = totalRev.toLocaleString('vi-VN');
        }
    </script>
</body>

</html>	
